close all 
clear 
echo on 
clc 
% NEWFF――生成一个新的前向神经网络 
% TRAIN――对 BP 神经网络进行训练 
% SIM――对 BP 神经网络进行仿真 
pause        
%  敲任意键开始 
clc 
%  定义训练样本 
% P 为输入矢量 
P=[0.018525555,0.033706954,0.040457842,0.049256385,0.016698949,0.008636854,7.65937E-20; 
   0.039033639,0.009128283,8.56151E-19,0.001767096,0.045500148,0.128824193,0.003672888;
   0.044872612,0.067308918,2.24363E-14,2.24363E-14,0.067308918,0.067308918,0.022436306;
   0.064502161,0.033809683,0.006314338,0.05019499,0.056509328,0.025257352,7.99283E-16;
   0.110066102,0.038619685,0.033102587,0.019309842,2.75855E-15,2.75855E-15,0.038619685;
   0.038422657,0.020315428,0.031798061,4.4164E-16,0.025173465,0.019873788,0.031356421;
   0.037067203,0.028119947,0.025563588,0.02172905,1.27818E-15,0.019172691,0.028119947;
0.026818018,0.041332279,0.01117765,2.08538E-16,0.047046227,0.070193971,0.012637417;
0.03161006,0.03161006,0.01580503,1.5805E-15,0.03161006,0.047415091,0.01580503;
0.064726035,0.064726035,6.4726E-15,6.4726E-15,0.12945207,0.12945207,6.4726E-15;
0.015419503,0.008116801,0.003901223,0.00255514,0.020634567,0.022875352,8.06038E-18;
0.023185715,0.014853348,0.013766518,3.62277E-15,0.005071875,0.018838393,0.000724554;
0.003000117,0.013058158,0.0077723,0.020652298,0.004907863,4.3348E-19,0.020256964;
0.014608149,0.002873734,0.020834573,0.007423813,0.004789557,2.39478E-13,0.019158228;
0.017759114,0.016871158,0.015983203,0.000887956,0.015095247,0.017759114,8.87956E-15;
0.001369959,0.003384604,8.05858E-17,0.004109876,0.00346519,0.004593391,0.001853474;
0.001467681,0.001420272,1.00872E-16,0.003521426,0.003402398,0.008698155,0.00102082;
0.00175684,0.003848317,8.36591E-17,0.002342454,0.005019544,0.004768567,0.001589522;
0.00415776,0.001954396,0.001574721,0.001145251,6.22419E-16,0.006995992,0.002452332;
0.00267966,0.001875762,0.000535932,2.67966E-15,0.007771015,0.005895253,0.003215593;
0.003668213,0.001598793,0.001515349,0.002036042,0.00409211,0.005267006,3.33777E-16;
0.003993072,0.002878726,0.00390021,0.001671519,0.002135829,4.64311E-17,0.002646571;
0.002776633,0.003182352,0.001204476,1.26787E-16,0.004538971,0.004209325,0.002446987;
0.000335813,0.000335813,0.000335813,0.000335813,0.000335813,0.000335813,0.000335813;
0.019569201,0.019569201,0.019569201,0.019569201,0.019569201,0.019569201,0.019569201;
0.005745337,0.005745337,0.005745337,0.005745337,0.005745337,0.005745337,0.005745337;
0.008189763,0.008189763,0.008189763,0.008189763,0.008189763,0.008189763,0.00818976
];%检验数据矩阵输入
% T 为目标矢量  
T = [0.7014765,0.238017725,0.714027231,0.420338184,0.640255972,0.49331758,0.077917551];
pause; 
clc 
%  创建一个新的前向神经网络 
net=newff(minmax(P),[3,1],{'tansig','purelin'},'traingdm')
%  当前输入层权值和阈值 
inputWeights=net.IW{1,1} 
inputbias=net.b{1} 
%  当前网络层权值和阈值 
layerWeights=net.LW{2,1} 
layerbias=net.b{2} 
pause 
clc 
%  设置训练参数 
net.trainParam.show = 50; 
net.trainParam.lr = 0.05; 
net.trainParam.mc = 0.9; 
net.trainParam.epochs = 1000; 
net.trainParam.goal = 1e-3; 
pause 
clc 
%  调用 TRAINGDM 算法训练 BP 网络 
[net,tr]=train(net,P,T); 
pause 
clc 
%  对 BP 网络进行仿真 
A = sim(net,P) 
%  计算仿真误差 
E = T - A 
MSE=mse(E) 
pause 
clc 
echo off
